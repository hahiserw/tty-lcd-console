// #include "stm32f4xx_conf.h"
#include <stdint.h>
#include "config.h"
#include "console.h"
#include "itm.h"

#include <string.h> // lcd_clear
#include <math.h>


// uint8_t screen[LCD_WIDTH * LCD_HEIGHT] = {255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,0,0,0,0,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,0,0,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,224,0,0,0,0,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,0,0,1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,0,0,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,128,0,0,0,0,0,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,0,0,0,0,3,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,0,0,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,7,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255};


// {{{ drawing
// XXX
#ifdef FONT_SMALL
#include "font-4x6.c"
#else
#include "font-7x12.c"
#endif

// XXX inline?
inline void lcd_draw_pixel(upos_t x, upos_t y, color_t color)
{
	if (color)
		(current_view->screen_buffer)[(y) * LCD_WIDTH + ((x) >> 3)] |=   1 << (7 - ((x) & 7));
	else
		(current_view->screen_buffer)[(y) * LCD_WIDTH + ((x) >> 3)] &= ~(1 << (7 - ((x) & 7)));
}

inline uint8_t lcd_get_pixel(upos_t x, upos_t y) // xxx pos_t x, pos_t y
{
	return (current_view->screen_buffer)[(y) * LCD_WIDTH + ((x) >> 3)]
		& (1 << (7 - ((x) & 7)));
}

inline void lcd_clear(uint8_t *data) {
	memset(data, 0, LCD_WIDTH * LCD_HEIGHT);
}

void lcd_clear_horizontal_line(uint8_t *data, uint8_t x) {
	uint8_t cell_position = (x >> 3);
	// uint8_t pixel_clear   = ~(x & 7);
	uint8_t pixel_clear   = ~(1 << (7 - (x & 7))); // right??
// #define lcd_pixel(data, x, y) data[(y) * LCD_WIDTH + ((x) >> 3)] |= 1 << (7 - ((x) & 7))

	//*
	for (uint8_t y = 0; y < LCD_HEIGHT; y++)
		data[y * LCD_WIDTH + cell_position] &= pixel_clear;

	// faster?
	/*/
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear; // {{{
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear;
	data[__COUNTER__ * LCD_WIDTH + cell_position] &= pixel_clear; // }}}
	// */
}

// void lcd_circle(uint8_t *data, uint32_t r, uint32_t x0, uint32_t y0) {
// 	for (uint8_t i = 0; i < 150; i++) {
// 		int y = y0 + r * sin(2*M_PI*i/150.0);
// 		int x = x0 + r * cos(2*M_PI*i/150.0);
//
// 		lcd_pixel(data, x, y);
// 	}
// }

// void lcd_write_char(uint8_t *data, int16_t x0, int16_t y0, unsigned char c)
// {
// 	int8_t i, j, line;
// 	int8_t descender;
// 	unsigned const char *glyph;
//
// 	glyph = &mcm_font[(c & 0x7f) * 9];
//
// 	descender = (*glyph & 0x80) != 0;
//
// 	for (i = 0; i < 12; i++) {
// 		line = 0x00;
// 		if (descender) {
// 			if (i > 2) {
// 				line = *(glyph + (i - 3));
// 			}
// 		} else {
// 			if (i < 9) {
// 				line = *(glyph + i);
// 			}
// 		}
// 		line &= 0x7f;
// 		for (j = 0; j < 8; j++) {
// 			if (line & 0x80) {
// 				// if (size == 1) #<{(| default size |)}>#
// 					// lcd_pixel(data, 8+x0-j, LCD_HEIGHT-y0-i); // wut
// 					// lcd_pixel(data, 8+x0-j, y0+i); // wut
// 					lcd_pixel(data, x0+j, y0+i); // wut
// 				// else {  #<{(| big size |)}>#
// 				// 	gfx_fillRect(x+(j*size), y+(i*size),
// 				// 		     size, size);
// 				// }
// 			}
// 			line <<= 1;
// 		}
// 	}
// }

// void lcd_write_text(uint8_t *data, int16_t x0, int16_t y0, char *text)
// {
// 	char *c = text;
// 	while (*c) {
// 		lcd_write_char(data, x0+8*(c-text), y0+12*((c-text)/50), *c); // FIXME
// 		c++;
// 	}
// }

// void lcd_draw(uint8_t *data) {
// 	lcd_clear(data);
//
// 	for (uint32_t i = 0; i < 80; i++) {
// 		lcd_pixel(data, i, i);
// 	}
//
// 	lcd_circle(data, 30, 80, 80);
//
// #define sin_y(x) (uint8_t)(80 + 80 * sin(2*M_PI*(x)/55)) // kurwa, wincyj niż 55 mo być
// 	for (uint32_t x = 0; x < 400; x++) {
// 		uint8_t y = sin_y(x);
// 		lcd_pixel(data, x, y);
// 	}
// }

// }}}


void lcd_init()
{
	CLR(CL1);
	CLR(CL2);
	CLR(DI);
	CLR(M);
}

#define pos_t uint8_t
// #define pos_t uint16_t

// volatile pos_t y  = 0;
// volatile pos_t x  = 0;
// volatile pos_t *d = NULL;
pos_t sy = 0;
pos_t sx = 0;
pos_t *d = NULL;
// uint8_t m = 0;

#ifdef LAME_RENDER
// void lcd_loop()
void lcd_line()
{
	d = current_view->screen_start;
	// d = screen + screen_offset;

	// frame data {{{
	for (sy = 0; sy < LCD_HEIGHT; sy++)
	{

#else
void lcd_line() {
#endif
	if (sy == 0)
		SET(DI);

	if (sy == 1)
		CLR(DI);

	// line data {{{
	for (sx = 0; sx < LCD_WIDTH; sx++)
	{
		// TODO check
		// if (d - screen_start >= SCREEN_BUFFER_SIZE) {
		// 	// if (screen_start - screen_buffer >= SCREEN_BUFFER_SIZE)
		// 	// 	d = screen_buffer + (d - screen_start);
		// 	// else
		// 		d = screen_start;
		// }
			// d = (SCREEN_BUFFER_SIZE % (d - screen_start)) + screen_buffer;
		if (d - current_view->screen_buffer >= SCREEN_BUFFER_SIZE) {
			// d = screen_start;
			d = current_view->screen_buffer;
			// d = screen_start + ((d - screen_buffer) % SCREEN_BUFFER_SIZE);
		}

// #define PIXELS_VALUE *d
#define PIXELS_VALUE *d ^ console.reverse

		SET(DATA_PINS(FIRST_NIBBLE(PIXELS_VALUE)));
		CLR(DATA_PINS(~FIRST_NIBBLE(PIXELS_VALUE)));

		// 4 pixels
		SET(CL2);
		DELAY;
		CLR(CL2);

		SET(DATA_PINS(SECOND_NIBBLE(PIXELS_VALUE)));
		CLR(DATA_PINS(~SECOND_NIBBLE(PIXELS_VALUE)));

		// 4 pixels
		SET(CL2);
		DELAY;
		CLR(CL2);

		d++;
	}
	// }}}

	// line
	SET(CL1);
	DELAY;
	CLR(CL1);

#ifdef LAME_RENDER
	}
	// }}}

	TGL(M);
#else
	sy++;
	if (sy >= LCD_HEIGHT) {
		sy = 0;
		d = current_view->screen_start;

		TGL(M);
	}
#endif
}
